(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();var St=Object.create,{getPrototypeOf:Rt,defineProperty:st,getOwnPropertyNames:_t}=Object,Ot=Object.prototype.hasOwnProperty,Nt=(r,t,e)=>{e=r!=null?St(Rt(r)):{};const n=st(e,"default",{value:r,enumerable:!0});for(let i of _t(r))Ot.call(n,i)||st(n,i,{get:()=>r[i],enumerable:!0});return n},J=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),Lt=J(r=>{function t(c){const u=c>>25;return(c&33554431)<<5^-(u>>0&1)&996825010^-(u>>1&1)&642813549^-(u>>2&1)&513874426^-(u>>3&1)&1027748829^-(u>>4&1)&705979059}function e(c){let u=1;for(let y=0;y<c.length;++y){const I=c.charCodeAt(y);if(I<33||I>126)return"Invalid prefix ("+c+")";u=t(u)^I>>5}u=t(u);for(let y=0;y<c.length;++y){const I=c.charCodeAt(y);u=t(u)^I&31}return u}function n(c,u,y,I){let p=0,g=0;const d=(1<<y)-1,w=[];for(let E=0;E<c.length;++E)for(p=p<<u|c[E],g+=u;g>=y;)g-=y,w.push(p>>g&d);if(I)g>0&&w.push(p<<y-g&d);else{if(g>=u)return"Excess padding";if(p<<y-g&d)return"Non-zero padding"}return w}function i(c){return n(c,8,5,!0)}function o(c){const u=n(c,5,8,!1);if(Array.isArray(u))return u}function s(c){const u=n(c,5,8,!1);if(Array.isArray(u))return u;throw new Error(u)}function a(c){let u;c==="bech32"?u=1:u=734539939;function y(d,w,E){if(E=E||90,d.length+7+w.length>E)throw new TypeError("Exceeds length limit");d=d.toLowerCase();let b=e(d);if(typeof b=="string")throw new Error(b);let B=d+"1";for(let v=0;v<w.length;++v){const m=w[v];if(m>>5!==0)throw new Error("Non 5-bit word");b=t(b)^m,B+=h.charAt(m)}for(let v=0;v<6;++v)b=t(b);b^=u;for(let v=0;v<6;++v){const m=b>>(5-v)*5&31;B+=h.charAt(m)}return B}function I(d,w){if(w=w||90,d.length<8)return d+" too short";if(d.length>w)return"Exceeds length limit";const E=d.toLowerCase(),b=d.toUpperCase();if(d!==E&&d!==b)return"Mixed-case string "+d;d=E;const B=d.lastIndexOf("1");if(B===-1)return"No separator character for "+d;if(B===0)return"Missing prefix for "+d;const v=d.slice(0,B),m=d.slice(B+1);if(m.length<6)return"Data too short";let k=e(v);if(typeof k=="string")return k;const it=[];for(let M=0;M<m.length;++M){const ot=m.charAt(M),j=l[ot];if(j===void 0)return"Unknown character "+ot;k=t(k)^j,!(M+6>=m.length)&&it.push(j)}return k!==u?"Invalid checksum for "+d:{prefix:v,words:it}}function p(d,w){const E=I(d,w);if(typeof E=="object")return E}function g(d,w){const E=I(d,w);if(typeof E=="object")return E;throw new Error(E)}return{decodeUnsafe:p,decode:g,encode:y,toWords:i,fromWordsUnsafe:o,fromWords:s}}Object.defineProperty(r,"__esModule",{value:!0}),r.bech32m=r.bech32=void 0;var h="qpzry9x8gf2tvdw0s3jn54khce6mua7l",l={};for(let c=0;c<h.length;c++){const u=h.charAt(c);l[u]=c}r.bech32=a("bech32"),r.bech32m=a("bech32m")}),Pt=J(r=>{function t(p){var g=p.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var d=p.indexOf("=");d===-1&&(d=g);var w=d===g?0:4-d%4;return[d,w]}function e(p){var g=t(p),d=g[0],w=g[1];return(d+w)*3/4-w}function n(p,g,d){return(g+d)*3/4-d}function i(p){var g,d=t(p),w=d[0],E=d[1],b=new c(n(p,w,E)),B=0,v=E>0?w-4:w,m;for(m=0;m<v;m+=4)g=l[p.charCodeAt(m)]<<18|l[p.charCodeAt(m+1)]<<12|l[p.charCodeAt(m+2)]<<6|l[p.charCodeAt(m+3)],b[B++]=g>>16&255,b[B++]=g>>8&255,b[B++]=g&255;return E===2&&(g=l[p.charCodeAt(m)]<<2|l[p.charCodeAt(m+1)]>>4,b[B++]=g&255),E===1&&(g=l[p.charCodeAt(m)]<<10|l[p.charCodeAt(m+1)]<<4|l[p.charCodeAt(m+2)]>>2,b[B++]=g>>8&255,b[B++]=g&255),b}function o(p){return h[p>>18&63]+h[p>>12&63]+h[p>>6&63]+h[p&63]}function s(p,g,d){for(var w,E=[],b=g;b<d;b+=3)w=(p[b]<<16&16711680)+(p[b+1]<<8&65280)+(p[b+2]&255),E.push(o(w));return E.join("")}function a(p){for(var g,d=p.length,w=d%3,E=[],b=16383,B=0,v=d-w;B<v;B+=b)E.push(s(p,B,B+b>v?v:B+b));return w===1?(g=p[d-1],E.push(h[g>>2]+h[g<<4&63]+"==")):w===2&&(g=(p[d-2]<<8)+p[d-1],E.push(h[g>>10]+h[g>>4&63]+h[g<<2&63]+"=")),E.join("")}r.byteLength=e,r.toByteArray=i,r.fromByteArray=a;var h=[],l=[],c=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(y=0,I=u.length;y<I;++y)h[y]=u[y],l[u.charCodeAt(y)]=y;var y,I;l[45]=62,l[95]=63}),Ft=J(r=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */r.read=function(t,e,n,i,o){var s,a,h=o*8-i-1,l=(1<<h)-1,c=l>>1,u=-7,y=n?o-1:0,I=n?-1:1,p=t[e+y];for(y+=I,s=p&(1<<-u)-1,p>>=-u,u+=h;u>0;s=s*256+t[e+y],y+=I,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=i;u>0;a=a*256+t[e+y],y+=I,u-=8);if(s===0)s=1-c;else{if(s===l)return a?NaN:(p?-1:1)*(1/0);a=a+Math.pow(2,i),s=s-c}return(p?-1:1)*a*Math.pow(2,s-i)},r.write=function(t,e,n,i,o,s){var a,h,l,c=s*8-o-1,u=(1<<c)-1,y=u>>1,I=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,g=i?1:-1,d=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(h=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+y>=1?e+=I/l:e+=I*Math.pow(2,1-y),e*l>=2&&(a++,l/=2),a+y>=u?(h=0,a=u):a+y>=1?(h=(e*l-1)*Math.pow(2,o),a=a+y):(h=e*Math.pow(2,y-1)*Math.pow(2,o),a=0));o>=8;t[n+p]=h&255,p+=g,h/=256,o-=8);for(a=a<<o|h,c+=o;c>0;t[n+p]=a&255,p+=g,a/=256,c-=8);t[n+p-g]|=d*128}}),Ct=Nt(Lt());function xt(){try{const r=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(r,t),r.foo()===42}catch{return!1}}function _(r){if(r>X)throw new RangeError('The value "'+r+'" is invalid for option "size"');const t=new Uint8Array(r);return Object.setPrototypeOf(t,f.prototype),t}function f(r,t,e){if(typeof r=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return $(r)}return dt(r,t,e)}function dt(r,t,e){if(typeof r=="string")return kt(r,t);if(ArrayBuffer.isView(r))return Dt(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(R(r,ArrayBuffer)||r&&R(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(R(r,SharedArrayBuffer)||r&&R(r.buffer,SharedArrayBuffer)))return W(r,t,e);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const n=r.valueOf&&r.valueOf();if(n!=null&&n!==r)return f.from(n,t,e);const i=Mt(r);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return f.from(r[Symbol.toPrimitive]("string"),t,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}function gt(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function Vt(r,t,e){return gt(r),r<=0?_(r):t!==void 0?typeof e=="string"?_(r).fill(t,e):_(r).fill(t):_(r)}function $(r){return gt(r),_(r<0?0:Y(r)|0)}function kt(r,t){if((typeof t!="string"||t==="")&&(t="utf8"),!f.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const e=yt(r,t)|0;let n=_(e);const i=n.write(r,t);return i!==e&&(n=n.slice(0,i)),n}function Z(r){const t=r.length<0?0:Y(r.length)|0,e=_(t);for(let n=0;n<t;n+=1)e[n]=r[n]&255;return e}function Dt(r){if(R(r,Uint8Array)){const t=new Uint8Array(r);return W(t.buffer,t.byteOffset,t.byteLength)}return Z(r)}function W(r,t,e){if(t<0||r.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<t+(e||0))throw new RangeError('"length" is outside of buffer bounds');let n;return t===void 0&&e===void 0?n=new Uint8Array(r):e===void 0?n=new Uint8Array(r,t):n=new Uint8Array(r,t,e),Object.setPrototypeOf(n,f.prototype),n}function Mt(r){if(f.isBuffer(r)){const t=Y(r.length)|0,e=_(t);return e.length===0||r.copy(e,0,0,t),e}if(r.length!==void 0)return typeof r.length!="number"||tt(r.length)?_(0):Z(r);if(r.type==="Buffer"&&Array.isArray(r.data))return Z(r.data)}function Y(r){if(r>=X)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+X.toString(16)+" bytes");return r|0}function yt(r,t){if(f.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||R(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const e=r.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&e===0)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":return q(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return At(r).length;default:if(i)return n?-1:q(r).length;t=(""+t).toLowerCase(),i=!0}}function Ht(r,t,e){let n=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,t>>>=0,e<=t))return"";for(r||(r="utf8");;)switch(r){case"hex":return $t(this,t,e);case"utf8":case"utf-8":return Et(this,t,e);case"ascii":return Kt(this,t,e);case"latin1":case"binary":return Jt(this,t,e);case"base64":return Gt(this,t,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Yt(this,t,e);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),n=!0}}function P(r,t,e){const n=r[t];r[t]=r[e],r[e]=n}function wt(r,t,e,n,i){if(r.length===0)return-1;if(typeof e=="string"?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,tt(e)&&(e=i?0:r.length-1),e<0&&(e=r.length+e),e>=r.length){if(i)return-1;e=r.length-1}else if(e<0)if(i)e=0;else return-1;if(typeof t=="string"&&(t=f.from(t,n)),f.isBuffer(t))return t.length===0?-1:ft(r,t,e,n,i);if(typeof t=="number")return t=t&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(r,t,e):Uint8Array.prototype.lastIndexOf.call(r,t,e):ft(r,[t],e,n,i);throw new TypeError("val must be string, number or Buffer")}function ft(r,t,e,n,i){let o=1,s=r.length,a=t.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(r.length<2||t.length<2)return-1;o=2,s/=2,a/=2,e/=2}function h(c,u){return o===1?c[u]:c.readUInt16BE(u*o)}let l;if(i){let c=-1;for(l=e;l<s;l++)if(h(r,l)===h(t,c===-1?0:l-c)){if(c===-1&&(c=l),l-c+1===a)return c*o}else c!==-1&&(l-=l-c),c=-1}else for(e+a>s&&(e=s-a),l=e;l>=0;l--){let c=!0;for(let u=0;u<a;u++)if(h(r,l+u)!==h(t,u)){c=!1;break}if(c)return l}return-1}function jt(r,t,e,n){e=Number(e)||0;const i=r.length-e;n?(n=Number(n),n>i&&(n=i)):n=i;const o=t.length;n>o/2&&(n=o/2);let s;for(s=0;s<n;++s){const a=parseInt(t.substr(s*2,2),16);if(tt(a))return s;r[e+s]=a}return s}function zt(r,t,e,n){return H(q(t,r.length-e),r,e,n)}function Zt(r,t,e,n){return H(ee(t),r,e,n)}function Wt(r,t,e,n){return H(At(t),r,e,n)}function qt(r,t,e,n){return H(re(t,r.length-e),r,e,n)}function Gt(r,t,e){return t===0&&e===r.length?G.fromByteArray(r):G.fromByteArray(r.slice(t,e))}function Et(r,t,e){e=Math.min(r.length,e);const n=[];let i=t;for(;i<e;){const o=r[i];let s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=e){let h,l,c,u;switch(a){case 1:o<128&&(s=o);break;case 2:h=r[i+1],(h&192)===128&&(u=(o&31)<<6|h&63,u>127&&(s=u));break;case 3:h=r[i+1],l=r[i+2],(h&192)===128&&(l&192)===128&&(u=(o&15)<<12|(h&63)<<6|l&63,u>2047&&(u<55296||u>57343)&&(s=u));break;case 4:h=r[i+1],l=r[i+2],c=r[i+3],(h&192)===128&&(l&192)===128&&(c&192)===128&&(u=(o&15)<<18|(h&63)<<12|(l&63)<<6|c&63,u>65535&&u<1114112&&(s=u))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),i+=a}return Xt(n)}function Xt(r){const t=r.length;if(t<=ht)return String.fromCharCode.apply(String,r);let e="",n=0;for(;n<t;)e+=String.fromCharCode.apply(String,r.slice(n,n+=ht));return e}function Kt(r,t,e){let n="";e=Math.min(r.length,e);for(let i=t;i<e;++i)n+=String.fromCharCode(r[i]&127);return n}function Jt(r,t,e){let n="";e=Math.min(r.length,e);for(let i=t;i<e;++i)n+=String.fromCharCode(r[i]);return n}function $t(r,t,e){const n=r.length;(!t||t<0)&&(t=0),(!e||e<0||e>n)&&(e=n);let i="";for(let o=t;o<e;++o)i+=se[r[o]];return i}function Yt(r,t,e){const n=r.slice(t,e);let i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}function T(r,t,e){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+t>e)throw new RangeError("Trying to access beyond buffer length")}function A(r,t,e,n,i,o){if(!f.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(e+n>r.length)throw new RangeError("Index out of range")}function bt(r,t,e,n,i){Tt(t,n,i,r,e,7);let o=Number(t&BigInt(4294967295));r[e++]=o,o=o>>8,r[e++]=o,o=o>>8,r[e++]=o,o=o>>8,r[e++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return r[e++]=s,s=s>>8,r[e++]=s,s=s>>8,r[e++]=s,s=s>>8,r[e++]=s,e}function It(r,t,e,n,i){Tt(t,n,i,r,e,7);let o=Number(t&BigInt(4294967295));r[e+7]=o,o=o>>8,r[e+6]=o,o=o>>8,r[e+5]=o,o=o>>8,r[e+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return r[e+3]=s,s=s>>8,r[e+2]=s,s=s>>8,r[e+1]=s,s=s>>8,r[e]=s,e+8}function mt(r,t,e,n,i,o){if(e+n>r.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function Bt(r,t,e,n,i){return t=+t,e=e>>>0,!i&&mt(r,t,e,4),V.write(r,t,e,n,23,4),e+4}function vt(r,t,e,n,i){return t=+t,e=e>>>0,!i&&mt(r,t,e,8),V.write(r,t,e,n,52,8),e+8}function Q(r,t,e){F[r]=class extends e{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}function ut(r){let t="",e=r.length;const n=r[0]==="-"?1:0;for(;e>=n+4;e-=3)t=`_${r.slice(e-3,e)}${t}`;return`${r.slice(0,e)}${t}`}function Qt(r,t,e){x(t,"offset"),(r[t]===void 0||r[t+e]===void 0)&&D(t,r.length-(e+1))}function Tt(r,t,e,n,i,o){if(r>e||r<t){const s=typeof t=="bigint"?"n":"";let a;throw t===0||t===BigInt(0)?a=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:a=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`,new F.ERR_OUT_OF_RANGE("value",a,r)}Qt(n,i,o)}function x(r,t){if(typeof r!="number")throw new F.ERR_INVALID_ARG_TYPE(t,"number",r)}function D(r,t,e){throw Math.floor(r)!==r?(x(r,e),new F.ERR_OUT_OF_RANGE("offset","an integer",r)):t<0?new F.ERR_BUFFER_OUT_OF_BOUNDS:new F.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${t}`,r)}function te(r){if(r=r.split("=")[0],r=r.trim().replace(oe,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function q(r,t){t=t||1/0;let e;const n=r.length;let i=null;const o=[];for(let s=0;s<n;++s){if(e=r.charCodeAt(s),e>55295&&e<57344){if(!i){if(e>56319){(t-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(t-=3)>-1&&o.push(239,191,189),i=e;continue}e=(i-55296<<10|e-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((t-=1)<0)break;o.push(e)}else if(e<2048){if((t-=2)<0)break;o.push(e>>6|192,e&63|128)}else if(e<65536){if((t-=3)<0)break;o.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((t-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return o}function ee(r){const t=[];for(let e=0;e<r.length;++e)t.push(r.charCodeAt(e)&255);return t}function re(r,t){let e,n,i;const o=[];for(let s=0;s<r.length&&!((t-=2)<0);++s)e=r.charCodeAt(s),n=e>>8,i=e%256,o.push(i),o.push(n);return o}function At(r){return G.toByteArray(te(r))}function H(r,t,e,n){let i;for(i=0;i<n&&!(i+e>=t.length||i>=r.length);++i)t[i+e]=r[i];return i}function R(r,t){return r instanceof t||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===t.name}function tt(r){return r!==r}function L(r){return typeof BigInt>"u"?ne:r}function ne(){throw new Error("BigInt not supported")}/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <https://feross.org>
* @license  MIT
*/var G=Pt(),V=Ft(),at=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null,C=f,ie=50,X=2147483647;f.TYPED_ARRAY_SUPPORT=xt();!f.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}});Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}});f.poolSize=8192;f.from=function(r,t,e){return dt(r,t,e)};Object.setPrototypeOf(f.prototype,Uint8Array.prototype);Object.setPrototypeOf(f,Uint8Array);f.alloc=function(r,t,e){return Vt(r,t,e)};f.allocUnsafe=function(r){return $(r)};f.allocUnsafeSlow=function(r){return $(r)};f.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==f.prototype};f.compare=function(t,e){if(R(t,Uint8Array)&&(t=f.from(t,t.offset,t.byteLength)),R(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),!f.isBuffer(t)||!f.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,i=e.length;for(let o=0,s=Math.min(n,i);o<s;++o)if(t[o]!==e[o]){n=t[o],i=e[o];break}return n<i?-1:i<n?1:0};f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};f.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return f.alloc(0);let n;if(e===void 0)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const i=f.allocUnsafe(e);let o=0;for(n=0;n<t.length;++n){let s=t[n];if(R(s,Uint8Array))o+s.length>i.length?(f.isBuffer(s)||(s=f.from(s)),s.copy(i,o)):Uint8Array.prototype.set.call(i,s,o);else if(f.isBuffer(s))s.copy(i,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return i};f.byteLength=yt;f.prototype._isBuffer=!0;f.prototype.swap16=function(){const t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)P(this,e,e+1);return this};f.prototype.swap32=function(){const t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)P(this,e,e+3),P(this,e+1,e+2);return this};f.prototype.swap64=function(){const t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)P(this,e,e+7),P(this,e+1,e+6),P(this,e+2,e+5),P(this,e+3,e+4);return this};f.prototype.toString=function(){const t=this.length;return t===0?"":arguments.length===0?Et(this,0,t):Ht.apply(this,arguments)};f.prototype.toLocaleString=f.prototype.toString;f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:f.compare(this,t)===0};f.prototype.inspect=function(){let t="";const e=ie;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"};at&&(f.prototype[at]=f.prototype.inspect);f.prototype.compare=function(t,e,n,i,o){if(R(t,Uint8Array)&&(t=f.from(t,t.offset,t.byteLength)),!f.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(e===void 0&&(e=0),n===void 0&&(n=t?t.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),e<0||n>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&e>=n)return 0;if(i>=o)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,i>>>=0,o>>>=0,this===t)return 0;let s=o-i,a=n-e;const h=Math.min(s,a),l=this.slice(i,o),c=t.slice(e,n);for(let u=0;u<h;++u)if(l[u]!==c[u]){s=l[u],a=c[u];break}return s<a?-1:a<s?1:0};f.prototype.includes=function(t,e,n){return this.indexOf(t,e,n)!==-1};f.prototype.indexOf=function(t,e,n){return wt(this,t,e,n,!0)};f.prototype.lastIndexOf=function(t,e,n){return wt(this,t,e,n,!1)};f.prototype.write=function(t,e,n,i){if(e===void 0)i="utf8",n=this.length,e=0;else if(n===void 0&&typeof e=="string")i=e,n=this.length,e=0;else if(isFinite(e))e=e>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const o=this.length-e;if((n===void 0||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return jt(this,t,e,n);case"utf8":case"utf-8":return zt(this,t,e,n);case"ascii":case"latin1":case"binary":return Zt(this,t,e,n);case"base64":return Wt(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return qt(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ht=4096;f.prototype.slice=function(t,e){const n=this.length;t=~~t,e=e===void 0?n:~~e,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),e<t&&(e=t);const i=this.subarray(t,e);return Object.setPrototypeOf(i,f.prototype),i};f.prototype.readUintLE=f.prototype.readUIntLE=function(t,e,n){t=t>>>0,e=e>>>0,!n&&T(t,e,this.length);let i=this[t],o=1,s=0;for(;++s<e&&(o*=256);)i+=this[t+s]*o;return i};f.prototype.readUintBE=f.prototype.readUIntBE=function(t,e,n){t=t>>>0,e=e>>>0,!n&&T(t,e,this.length);let i=this[t+--e],o=1;for(;e>0&&(o*=256);)i+=this[t+--e]*o;return i};f.prototype.readUint8=f.prototype.readUInt8=function(t,e){return t=t>>>0,!e&&T(t,1,this.length),this[t]};f.prototype.readUint16LE=f.prototype.readUInt16LE=function(t,e){return t=t>>>0,!e&&T(t,2,this.length),this[t]|this[t+1]<<8};f.prototype.readUint16BE=f.prototype.readUInt16BE=function(t,e){return t=t>>>0,!e&&T(t,2,this.length),this[t]<<8|this[t+1]};f.prototype.readUint32LE=f.prototype.readUInt32LE=function(t,e){return t=t>>>0,!e&&T(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};f.prototype.readUint32BE=f.prototype.readUInt32BE=function(t,e){return t=t>>>0,!e&&T(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};f.prototype.readBigUInt64LE=L(function(t){t=t>>>0,x(t,"offset");const e=this[t],n=this[t+7];(e===void 0||n===void 0)&&D(t,this.length-8);const i=e+this[++t]*256+this[++t]*65536+this[++t]*16777216,o=this[++t]+this[++t]*256+this[++t]*65536+n*16777216;return BigInt(i)+(BigInt(o)<<BigInt(32))});f.prototype.readBigUInt64BE=L(function(t){t=t>>>0,x(t,"offset");const e=this[t],n=this[t+7];(e===void 0||n===void 0)&&D(t,this.length-8);const i=e*16777216+this[++t]*65536+this[++t]*256+this[++t],o=this[++t]*16777216+this[++t]*65536+this[++t]*256+n;return(BigInt(i)<<BigInt(32))+BigInt(o)});f.prototype.readIntLE=function(t,e,n){t=t>>>0,e=e>>>0,!n&&T(t,e,this.length);let i=this[t],o=1,s=0;for(;++s<e&&(o*=256);)i+=this[t+s]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i};f.prototype.readIntBE=function(t,e,n){t=t>>>0,e=e>>>0,!n&&T(t,e,this.length);let i=e,o=1,s=this[t+--i];for(;i>0&&(o*=256);)s+=this[t+--i]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*e)),s};f.prototype.readInt8=function(t,e){return t=t>>>0,!e&&T(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]};f.prototype.readInt16LE=function(t,e){t=t>>>0,!e&&T(t,2,this.length);const n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};f.prototype.readInt16BE=function(t,e){t=t>>>0,!e&&T(t,2,this.length);const n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};f.prototype.readInt32LE=function(t,e){return t=t>>>0,!e&&T(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};f.prototype.readInt32BE=function(t,e){return t=t>>>0,!e&&T(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};f.prototype.readBigInt64LE=L(function(t){t=t>>>0,x(t,"offset");const e=this[t],n=this[t+7];(e===void 0||n===void 0)&&D(t,this.length-8);const i=this[t+4]+this[t+5]*256+this[t+6]*65536+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(e+this[++t]*256+this[++t]*65536+this[++t]*16777216)});f.prototype.readBigInt64BE=L(function(t){t=t>>>0,x(t,"offset");const e=this[t],n=this[t+7];(e===void 0||n===void 0)&&D(t,this.length-8);const i=(e<<24)+this[++t]*65536+this[++t]*256+this[++t];return(BigInt(i)<<BigInt(32))+BigInt(this[++t]*16777216+this[++t]*65536+this[++t]*256+n)});f.prototype.readFloatLE=function(t,e){return t=t>>>0,!e&&T(t,4,this.length),V.read(this,t,!0,23,4)};f.prototype.readFloatBE=function(t,e){return t=t>>>0,!e&&T(t,4,this.length),V.read(this,t,!1,23,4)};f.prototype.readDoubleLE=function(t,e){return t=t>>>0,!e&&T(t,8,this.length),V.read(this,t,!0,52,8)};f.prototype.readDoubleBE=function(t,e){return t=t>>>0,!e&&T(t,8,this.length),V.read(this,t,!1,52,8)};f.prototype.writeUintLE=f.prototype.writeUIntLE=function(t,e,n,i){if(t=+t,e=e>>>0,n=n>>>0,!i){const a=Math.pow(2,8*n)-1;A(this,t,e,n,a,0)}let o=1,s=0;for(this[e]=t&255;++s<n&&(o*=256);)this[e+s]=t/o&255;return e+n};f.prototype.writeUintBE=f.prototype.writeUIntBE=function(t,e,n,i){if(t=+t,e=e>>>0,n=n>>>0,!i){const a=Math.pow(2,8*n)-1;A(this,t,e,n,a,0)}let o=n-1,s=1;for(this[e+o]=t&255;--o>=0&&(s*=256);)this[e+o]=t/s&255;return e+n};f.prototype.writeUint8=f.prototype.writeUInt8=function(t,e,n){return t=+t,e=e>>>0,!n&&A(this,t,e,1,255,0),this[e]=t&255,e+1};f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(t,e,n){return t=+t,e=e>>>0,!n&&A(this,t,e,2,65535,0),this[e]=t&255,this[e+1]=t>>>8,e+2};f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(t,e,n){return t=+t,e=e>>>0,!n&&A(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=t&255,e+2};f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(t,e,n){return t=+t,e=e>>>0,!n&&A(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t&255,e+4};f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(t,e,n){return t=+t,e=e>>>0,!n&&A(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};f.prototype.writeBigUInt64LE=L(function(t,e=0){return bt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))});f.prototype.writeBigUInt64BE=L(function(t,e=0){return It(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))});f.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e=e>>>0,!i){const h=Math.pow(2,8*n-1);A(this,t,e,n,h-1,-h)}let o=0,s=1,a=0;for(this[e]=t&255;++o<n&&(s*=256);)t<0&&a===0&&this[e+o-1]!==0&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n};f.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e=e>>>0,!i){const h=Math.pow(2,8*n-1);A(this,t,e,n,h-1,-h)}let o=n-1,s=1,a=0;for(this[e+o]=t&255;--o>=0&&(s*=256);)t<0&&a===0&&this[e+o+1]!==0&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n};f.prototype.writeInt8=function(t,e,n){return t=+t,e=e>>>0,!n&&A(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=t&255,e+1};f.prototype.writeInt16LE=function(t,e,n){return t=+t,e=e>>>0,!n&&A(this,t,e,2,32767,-32768),this[e]=t&255,this[e+1]=t>>>8,e+2};f.prototype.writeInt16BE=function(t,e,n){return t=+t,e=e>>>0,!n&&A(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=t&255,e+2};f.prototype.writeInt32LE=function(t,e,n){return t=+t,e=e>>>0,!n&&A(this,t,e,4,2147483647,-2147483648),this[e]=t&255,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4};f.prototype.writeInt32BE=function(t,e,n){return t=+t,e=e>>>0,!n&&A(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};f.prototype.writeBigInt64LE=L(function(t,e=0){return bt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});f.prototype.writeBigInt64BE=L(function(t,e=0){return It(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});f.prototype.writeFloatLE=function(t,e,n){return Bt(this,t,e,!0,n)};f.prototype.writeFloatBE=function(t,e,n){return Bt(this,t,e,!1,n)};f.prototype.writeDoubleLE=function(t,e,n){return vt(this,t,e,!0,n)};f.prototype.writeDoubleBE=function(t,e,n){return vt(this,t,e,!1,n)};f.prototype.copy=function(t,e,n,i){if(!f.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);const o=i-n;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(e,n,i):Uint8Array.prototype.set.call(t,this.subarray(n,i),e),o};f.prototype.fill=function(t,e,n,i){if(typeof t=="string"){if(typeof e=="string"?(i=e,e=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!f.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(t.length===1){const s=t.charCodeAt(0);(i==="utf8"&&s<128||i==="latin1")&&(t=s)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e=e>>>0,n=n===void 0?this.length:n>>>0,!t&&(t=0);let o;if(typeof t=="number")for(o=e;o<n;++o)this[o]=t;else{const s=f.isBuffer(t)?t:f.from(t,i),a=s.length;if(a===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var F={};Q("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Q("ERR_INVALID_ARG_TYPE",function(r,t){return`The "${r}" argument must be of type number. Received type ${typeof t}`},TypeError);Q("ERR_OUT_OF_RANGE",function(r,t,e){let n=`The value of "${r}" is out of range.`,i=e;return Number.isInteger(e)&&Math.abs(e)>4294967296?i=ut(String(e)):typeof e=="bigint"&&(i=String(e),(e>BigInt(2)**BigInt(32)||e<-(BigInt(2)**BigInt(32)))&&(i=ut(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n},RangeError);var oe=/[^+/0-9A-Za-z-_]/g,se=(function(){const r=new Array(256);for(let t=0;t<16;++t){const e=t*16;for(let n=0;n<16;++n)r[e+n]="0123456789abcdef"[t]+"0123456789abcdef"[n]}return r})();class U extends Error{constructor(t){super(t),this.name="TLVParsingError"}}class fe{position=0;buffer;constructor(t){this.buffer=t}parseBigSize(){if(this.position>=this.buffer.length)throw new U("Unexpected end of data while parsing BigSize");const t=this.buffer[this.position];if(t<=252)return this.position+=1,BigInt(t);if(t===253){if(this.position+3>this.buffer.length)throw new U("Insufficient bytes for 2-byte BigSize");const e=this.buffer.readUInt16BE(this.position+1);if(e<=252)throw new U("Non-minimal BigSize encoding");return this.position+=3,BigInt(e)}if(t===254){if(this.position+5>this.buffer.length)throw new U("Insufficient bytes for 4-byte BigSize");const e=this.buffer.readUInt32BE(this.position+1);if(e<=65535)throw new U("Non-minimal BigSize encoding");return this.position+=5,BigInt(e)}if(t===255){if(this.position+9>this.buffer.length)throw new U("Insufficient bytes for 8-byte BigSize");const e=this.buffer.readBigUInt64BE(this.position+1);if(BigInt(e.toString())<=0xffffffffn)throw new U("Non-minimal BigSize encoding");return this.position+=9,BigInt(e.toString())}throw new U("Invalid BigSize encoding")}parseTLVRecord(){const t=this.parseBigSize(),e=this.parseBigSize();if(this.position+Number(e)>this.buffer.length)throw new U("Insufficient bytes for TLV value");const n=this.buffer.subarray(this.position,this.position+Number(e));return this.position+=Number(e),{type:t,length:e,value:C.from(n)}}parseTLVStream(){const t=[];let e=BigInt(-1);for(;this.position<this.buffer.length;){const n=this.parseTLVRecord();if(n.type<=e)throw new U("TLV records not in strictly-increasing order");if(n.type>=BigInt(65536)&&n.type%BigInt(2)===BigInt(0))throw new U("Unknown even-typed record encountered");t.push(n),e=n.type}return t}}class ue{$;pos=0;constructor(t){this.buffer=t}readBytes(t){const e=this.buffer.subarray(this.pos,this.pos+t);return this.pos+=t,C.from(e)}readByte(){return this.readBytes(1)[0]}readUInt16(){const t=this.buffer.readUInt16BE(this.pos);return this.pos+=2,t}readPoint(){return this.readBytes(33)}decodeBlindedPathHop(){const t=this.readPoint().toString("hex"),e=this.readUInt16(),n=this.readBytes(e).toString("hex");return{blindedNodeId:t,encryptedRecipientData:n}}decodeBlindedPath(){const t=this.readPoint().toString("hex"),e=this.readPoint().toString("hex"),n=this.readByte(),i=[];for(let o=0;o<n;o++)i.push(this.decodeBlindedPathHop());return{firstNodeId:t,firstPathKey:e,numHops:n,path:i}}decodeBlindedPaths(){const t=[];for(;this.pos<this.buffer.length;)t.push(this.decodeBlindedPath());return t}}function ae(r){return r instanceof Uint8Array||r!=null&&typeof r=="object"&&r.constructor.name==="Uint8Array"}function et(r,...t){if(!ae(r))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(r.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${r.length}`)}function ct(r,t=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(t&&r.finished)throw new Error("Hash#digest() has already been called")}function he(r,t){et(r);const e=t.outputLen;if(r.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}function ce(r){et(r);let t="";for(let e=0;e<r.length;e++)t+=de[r[e]];return t}function le(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Ut(r){return typeof r=="string"&&(r=le(r)),et(r),r}function pe(r){const t=n=>r().update(Ut(n)).digest(),e=r();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>r(),t}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */var z=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),S=(r,t)=>r<<32-t|r>>>t;new Uint8Array(new Uint32Array([287454020]).buffer)[0];var de=Array.from({length:256},(r,t)=>t.toString(16).padStart(2,"0"));class ge{clone(){return this._cloneInto()}}function ye(r,t,e,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(t,e,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(e>>i&o),a=Number(e&o),h=n?4:0,l=n?0:4;r.setUint32(t+h,s,n),r.setUint32(t+l,a,n)}var we=(r,t,e)=>r&t^~r&e,Ee=(r,t,e)=>r&t^r&e^t&e;class be extends ge{constructor(t,e,n,i){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=z(this.buffer)}update(t){ct(this);const{view:e,buffer:n,blockLen:i}=this;t=Ut(t);const o=t.length;for(let s=0;s<o;){const a=Math.min(i-this.pos,o-s);if(a===i){const h=z(t);for(;i<=o-s;s+=i)this.process(h,s);continue}n.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ct(this),he(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:i,isLE:o}=this;let{pos:s}=this;e[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let u=s;u<i;u++)e[u]=0;ye(n,i-8,BigInt(this.length*8),o),this.process(n,0);const a=z(t),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=h/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)a.setUint32(4*u,c[u],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return t.length=i,t.pos=a,t.finished=o,t.destroyed=s,i%e&&t.buffer.set(n),t}}var Ie=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),O=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),N=new Uint32Array(64);class me extends be{constructor(){super(64,32,8,!1),this.A=O[0]|0,this.B=O[1]|0,this.C=O[2]|0,this.D=O[3]|0,this.E=O[4]|0,this.F=O[5]|0,this.G=O[6]|0,this.H=O[7]|0}get(){const{A:t,B:e,C:n,D:i,E:o,F:s,G:a,H:h}=this;return[t,e,n,i,o,s,a,h]}set(t,e,n,i,o,s,a,h){this.A=t|0,this.B=e|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=h|0}process(t,e){for(let u=0;u<16;u++,e+=4)N[u]=t.getUint32(e,!1);for(let u=16;u<64;u++){const y=N[u-15],I=N[u-2],p=S(y,7)^S(y,18)^y>>>3,g=S(I,17)^S(I,19)^I>>>10;N[u]=g+N[u-7]+p+N[u-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:h,G:l,H:c}=this;for(let u=0;u<64;u++){const y=S(a,6)^S(a,11)^S(a,25),I=c+y+we(a,h,l)+Ie[u]+N[u]|0,p=(S(n,2)^S(n,13)^S(n,22))+Ee(n,i,o)|0;c=l,l=h,h=a,a=s+I|0,s=o,o=i,i=n,n=I+p|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,h=h+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(n,i,o,s,a,h,l,c)}roundClean(){N.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}var Be=pe(()=>new me);function lt(r){if(r<BigInt(Te))return new Uint8Array([Number(r)]);if(r<BigInt(65536)){const t=new Uint8Array(3);return t[0]=Ae,new DataView(t.buffer).setUint16(1,Number(r),!1),t}else if(r<BigInt(4294967296)){const t=new Uint8Array(5);return t[0]=Ue,new DataView(t.buffer).setUint32(1,Number(r),!1),t}else{const t=new Uint8Array(9);t[0]=Se;const e=Number(r>>BigInt(32)),n=Number(r&BigInt(4294967295)),i=new DataView(t.buffer);return i.setUint32(1,e,!1),i.setUint32(5,n,!1),t}}function pt(r){if(r.type<BigInt(0)||r.length<BigInt(0))throw new Error("Type and length must be non-negative");if(r.value.length!==Number(r.length))throw new Error("Value length does not match length field");const t=lt(r.type),e=lt(r.length),n=t.length+e.length+r.value.length,i=new Uint8Array(n);return i.set(t,0),i.set(e,t.length),i.set(r.value,t.length+e.length),i}function ve(r){const t=r.reduce((i,o)=>{const s=pt(o);return i+s.length},0),e=new Uint8Array(t);let n=0;for(let i of r){const o=pt(i);e.set(o,n),n+=o.length}return ce(Be(e))}var Te=253,Ae=253,Ue=254,Se=255;class rt{position=0;buffer;constructor(t){this.buffer=t}readUInt32BE(){if(this.position+4>this.buffer.length)throw new Error("Buffer overflow while reading uint32");const t=this.buffer.readUInt32BE(this.position);return this.position+=4,t}readUInt16BE(){if(this.position+2>this.buffer.length)throw new Error("Buffer overflow while reading uint16");const t=this.buffer.readUInt16BE(this.position);return this.position+=2,t}readUInt64BE(){if(this.position+8>this.buffer.length)throw new Error("Buffer overflow while reading uint64");const t=this.buffer.readBigUInt64BE(this.position);return this.position+=8,BigInt(t.toString())}readBytes(t){if(this.position+t>this.buffer.length)throw new Error("Buffer overflow while reading bytes");const e=this.buffer.subarray(this.position,this.position+t);return this.position+=t,C.from(e)}parseSinglePayInfo(){const t=this.readUInt32BE(),e=this.readUInt32BE(),n=this.readUInt16BE(),i=this.readUInt64BE().toString(),o=this.readUInt64BE().toString(),s=this.readUInt16BE();if(s>1024)throw new Error("Feature vector too long");const a=this.readBytes(s).toString("hex");if(i>o)throw new Error("HTLC minimum larger than maximum");if(n===0)throw new Error("CLTV expiry delta cannot be zero");if(e>1e6)throw new Error("Fee rate too high");return{feeBaseMsat:t,feeProportionalMillionths:e,cltvExpiryDelta:n,htlcMinimumMsat:i,htlcMaximumMsat:o,features:a}}parse(){const t=[];for(;this.position<this.buffer.length;)try{t.push(this.parseSinglePayInfo())}catch(e){throw new Error(`Failed to parse blinded pay info: ${e.message}`)}if(t.length===0)throw new Error("No blinded pay info found");return t}static parse(t){return new rt(t).parse()}}class nt{position=0;buffer;constructor(t){this.buffer=t}readUInt8(){if(this.position>=this.buffer.length)throw new Error("Buffer overflow while reading version");return this.buffer[this.position++]}readUInt16BE(){if(this.position+2>this.buffer.length)throw new Error("Buffer overflow while reading length");const t=this.buffer.readUInt16BE(this.position);return this.position+=2,t}readBytes(t){if(this.position+t>this.buffer.length)throw new Error("Buffer overflow while reading address");const e=this.buffer.subarray(this.position,this.position+t);return this.position+=t,C.from(e)}parseSingleAddress(){const t=this.readUInt8();if(t>16)throw new Error("Invalid witness version");const e=this.readUInt16BE();if(e<2||e>40)throw new Error("Invalid witness program length");const n=this.readBytes(e);switch(t){case 0:if(e!==20&&e!==32)throw new Error("Invalid P2WPKH/P2WSH witness program length");break;case 1:if(e!==32)throw new Error("Invalid Taproot witness program length");break}return{version:t,address:n}}parse(){const t=[];for(;this.position<this.buffer.length;)try{t.push(this.parseSingleAddress())}catch(e){throw new Error(`Failed to parse fallback address: ${e.message}`)}return t}static parse(t){return new nt(t).parse()}}class Re{static OFFER_PREFIX="lno";static INVOICE_REQUEST_PREFIX="lnr";static INVOICE_PREFIX="lni";static TLV_TYPES={OFFER_CHAINS:2n,OFFER_METADATA:4n,OFFER_CURRENCY:6n,OFFER_AMOUNT:8n,OFFER_DESCRIPTION:10n,OFFER_FEATURES:12n,OFFER_ABSOLUTE_EXPIRY:14n,OFFER_PATHS:16n,OFFER_ISSUER:18n,OFFER_QUANTITY_MAX:20n,OFFER_ISSUER_ID:22n,INVREQ_METADATA:0n,INVREQ_CHAIN:80n,INVREQ_AMOUNT:82n,INVREQ_FEATURES:84n,INVREQ_QUANTITY:86n,INVREQ_PAYER_ID:88n,INVREQ_PAYER_NOTE:89n,INVREQ_PATHS:90n,INVOICE_PATHS:160n,INVOICE_BLINDEDPAY:162n,INVOICE_CREATED_AT:164n,INVOICE_RELATIVE_EXPIRY:166n,INVOICE_PAYMENT_HASH:168n,INVOICE_AMOUNT:170n,INVOICE_FALLBACKS:172n,INVOICE_FEATURES:174n,INVOICE_NODE_ID:176n,SIGNATURE:240n};static decode(t){const e=t.toLowerCase();if(e.startsWith(this.OFFER_PREFIX))return this.parseOffer(t);if(e.startsWith(this.INVOICE_REQUEST_PREFIX))return this.parseInvoiceRequest(t);if(e.startsWith(this.INVOICE_PREFIX))return this.parseInvoice(t);throw new Error("Invalid BOLT12 message prefix")}static parseBech32(t){const e=t.replace(/\+\s*/g,"").toLowerCase().split("1");if(e.length!==2)throw new Error("Invalid BOLT12 format: missing separator");const[n,i]=e,o="qpzry9x8gf2tvdw0s3jn54khce6mua7l",s=[];for(let h of i){const l=o.indexOf(h);if(l===-1)throw new Error("Invalid character in data part");s.push(l)}const a=C.from(Ct.bech32.fromWords(s));return new fe(a).parseTLVStream()}static parseOffer(t){const e=this.parseBech32(t),n={id:"",type:"offer"};for(let i of e)switch(i.type){case this.TLV_TYPES.OFFER_CHAINS:n.chains=this.parseChainHashes(i.value);break;case this.TLV_TYPES.OFFER_METADATA:n.metadata=i.value.toString("hex");break;case this.TLV_TYPES.OFFER_CURRENCY:n.currency=i.value.toString("utf8");break;case this.TLV_TYPES.OFFER_AMOUNT:n.amount=this.parseTruncatedUint(i.value).toString();break;case this.TLV_TYPES.OFFER_DESCRIPTION:n.description=i.value.toString("utf8");break;case this.TLV_TYPES.OFFER_FEATURES:n.features=i.value.toString("hex");break;case this.TLV_TYPES.OFFER_ABSOLUTE_EXPIRY:n.absoluteExpiry=Number(this.parseTruncatedUint(i.value));break;case this.TLV_TYPES.OFFER_PATHS:n.paths=this.parseBlindedPaths(i.value);break;case this.TLV_TYPES.OFFER_ISSUER:n.issuer=i.value.toString("utf8");break;case this.TLV_TYPES.OFFER_QUANTITY_MAX:n.quantityMax=Number(this.parseTruncatedUint(i.value));break;case this.TLV_TYPES.OFFER_ISSUER_ID:n.issuerId=this.parsePoint(i.value);break}return n.id=ve(e),n}static parseInvoiceRequest(t){const e=this.parseBech32(t),n={...this.parseOffer(t),type:"invoice_request"};for(let i of e)switch(i.type){case this.TLV_TYPES.INVREQ_METADATA:n.metadata=i.value.toString("hex");break;case this.TLV_TYPES.INVREQ_CHAIN:n.chain=this.parseChainHash(i.value);break;case this.TLV_TYPES.INVREQ_AMOUNT:n.amount=this.parseTruncatedUint(i.value).toString();break;case this.TLV_TYPES.INVREQ_FEATURES:n.features=i.value.toString("hex");break;case this.TLV_TYPES.INVREQ_QUANTITY:n.quantity=Number(this.parseTruncatedUint(i.value));break;case this.TLV_TYPES.INVREQ_PAYER_ID:n.payerId=this.parsePoint(i.value);break;case this.TLV_TYPES.INVREQ_PAYER_NOTE:n.payerNote=i.value.toString("utf8");break;case this.TLV_TYPES.INVREQ_PATHS:n.paths=this.parseBlindedPaths(i.value);break;case this.TLV_TYPES.SIGNATURE:n.signature=i.value.toString("hex");break}if(!n.metadata||!n.payerId||!n.signature)throw new Error("Missing required invoice request fields");return n}static parseInvoice(t){const e=this.parseBech32(t),n={...this.parseInvoiceRequest(t),type:"invoice"};for(let i of e)switch(i.type){case this.TLV_TYPES.INVOICE_PATHS:n.paths=this.parseBlindedPaths(i.value);break;case this.TLV_TYPES.INVOICE_BLINDEDPAY:n.blindedPayInfo=this.parseBlindedPayInfo(i.value);break;case this.TLV_TYPES.INVOICE_CREATED_AT:n.createdAt=Number(this.parseTruncatedUint(i.value));break;case this.TLV_TYPES.INVOICE_RELATIVE_EXPIRY:n.relativeExpiry=Number(this.parseTruncatedUint(i.value));break;case this.TLV_TYPES.INVOICE_PAYMENT_HASH:n.paymentHash=i.value.toString("hex");break;case this.TLV_TYPES.INVOICE_AMOUNT:n.amount=this.parseTruncatedUint(i.value).toString();break;case this.TLV_TYPES.INVOICE_FALLBACKS:n.fallbacks=this.parseFallbacks(i.value);break;case this.TLV_TYPES.INVOICE_FEATURES:n.features=i.value.toString("hex");break;case this.TLV_TYPES.INVOICE_NODE_ID:n.nodeId=this.parsePoint(i.value);break}if(!n.paths||!n.createdAt||!n.paymentHash||typeof n.amount>"u"||!n.nodeId)throw new Error("Missing required invoice fields");return n}static parseChainHash(t){if(t.length!==32)throw new Error("Invalid chain hash length");return t.toString("hex")}static parseChainHashes(t){const e=[];for(let n=0;n<t.length;n+=32)e.push(this.parseChainHash(C.from(t.subarray(n,n+32))));return e}static parsePoint(t){if(t.length!==33)throw new Error("Invalid point length");return t.toString("hex")}static parseTruncatedUint(t){if(t.length>8)throw new Error("Invalid truncated uint length");let e=0n;for(let n=0;n<t.length;n++)e=e<<8n|BigInt(t[n]);return e}static parseBlindedPaths(t){return new ue(t).decodeBlindedPaths()}static parseBlindedPayInfo(t){return rt.parse(t)}static parseFallbacks(t){return nt.parse(t)}}var K=Re;console.log("BOLT12Decoder imported:",K);class _e{constructor(){this.inputField=document.getElementById("input-field"),this.outputContent=document.getElementById("output-content"),this.stringType=document.getElementById("string-type"),this.statusText=document.querySelector(".status-text"),this.pasteButton=document.getElementById("paste-button"),this.init()}init(){this.inputField.addEventListener("input",this.handleInput.bind(this)),this.inputField.addEventListener("paste",this.handlePaste.bind(this)),this.pasteButton.addEventListener("click",this.handlePasteButton.bind(this)),this.loadVersion(),this.updateStatus("Ready - Paste a BOLT12 string to decode")}handleInput(t){const e=t.target.value.trim();e?this.decodeString(e):this.clearOutput()}handlePaste(t){setTimeout(()=>{const e=this.inputField.value.trim();e&&this.decodeString(e)},10)}async handlePasteButton(){try{const t=await navigator.clipboard.readText();this.inputField.value=t,this.inputField.focus(),t.trim()&&this.decodeString(t.trim())}catch(t){this.updateStatus("Failed to read clipboard - try pasting manually"),console.error("Clipboard read failed:",t)}}decodeString(t){this.updateStatus("Decoding...");try{const e=this.detectAndDecode(t);e.success?(this.displayResult(e),this.updateStatus(`Successfully decoded ${e.type}`)):(this.displayError(e.error),this.updateStatus("Decoding failed"))}catch(e){this.displayError(`Unexpected error: ${e.message}`),this.updateStatus("Error occurred")}}detectAndDecode(t){const e=t.replace(/\s/g,"");return e.startsWith("lno1")?this.decodeBOLT12(e,"offer"):e.startsWith("lni1")?this.decodeBOLT12(e,"invoice"):{success:!1,error:'Not a recognized BOLT12 string. Expected strings starting with "lno1" (offers) or "lni1" (invoices).'}}decodeBOLT12(t,e){try{if(typeof K>"u")throw new Error("BOLT12Decoder library not loaded");const n=K.decode(t);return n.type!==e?{success:!1,error:`Type mismatch: expected ${e}, got ${n.type}`}:{success:!0,type:n.type,data:n}}catch(n){return{success:!1,error:`BOLT12 decoding failed: ${n.message}`}}}displayResult(t){this.stringType.textContent=t.type.toUpperCase(),this.stringType.className="string-type success";const e=this.formatJSON(t.data);this.outputContent.innerHTML=e,this.outputContent.className="output-content success"}displayError(t){this.stringType.textContent="ERROR",this.stringType.className="string-type error",this.outputContent.innerHTML=`<div class="error">${this.escapeHtml(t)}</div>`,this.outputContent.className="output-content error"}clearOutput(){this.stringType.textContent="",this.stringType.className="string-type",this.outputContent.innerHTML='<div class="placeholder">Waiting for input...</div>',this.outputContent.className="output-content",this.updateStatus("Ready - Paste a BOLT12 string to decode")}formatJSON(t){const e=JSON.stringify(t,null,2);return this.syntaxHighlight(e)}syntaxHighlight(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,e=>{let n="json-number";return/^"/.test(e)?/:$/.test(e)?n="json-key":n="json-string":/true|false/.test(e)?n="json-boolean":/null/.test(e)&&(n="json-null"),'<span class="'+n+'">'+e+"</span>"})}escapeHtml(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}updateStatus(t){this.statusText.textContent=t}async loadVersion(){try{const e=await(await fetch("/bullishdecoder/package.json")).json(),n=document.getElementById("version");n&&(n.textContent=`v${e.version}`)}catch(t){console.error("Failed to load version:",t);const e=document.getElementById("version");e&&(e.textContent="v0.0.3")}}}document.addEventListener("DOMContentLoaded",()=>{new _e});"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("sw.js").then(r=>{console.log("SW registered: ",r)}).catch(r=>{console.log("SW registration failed: ",r)})});
